@{
    ViewData["Title"] = "Facturas";
}

<h1>Gestión de Facturas</h1>

<div class="mb-3">
    <button type="button" class="btn btn-primary" id="btnNuevaFactura">
        <i class="bi bi-plus"></i> Nueva Factura
    </button>
</div>

<div class="card mb-3">
    <div class="card-body">
        <h5 class="card-title">Filtros</h5>
        <form id="formFiltros" class="row g-3">
            <div class="col-md-3">
                <label for="filtroCliente" class="form-label">Cliente</label>
                <select class="form-select" id="filtroCliente">
                    <option value="">Todos</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="filtroDesde" class="form-label">Desde</label>
                <input type="date" class="form-control" id="filtroDesde" />
            </div>
            <div class="col-md-3">
                <label for="filtroHasta" class="form-label">Hasta</label>
                <input type="date" class="form-control" id="filtroHasta" />
            </div>
            <div class="col-md-3">
                <label for="filtroEstado" class="form-label">Estado</label>
                <select class="form-select" id="filtroEstado">
                    <option value="">Todos</option>
                </select>
            </div>
            <div class="col-12">
                <button type="button" class="btn btn-primary" id="btnFiltrar">Filtrar</button>
                <button type="button" class="btn btn-secondary" id="btnLimpiarFiltros">Limpiar</button>
            </div>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <table id="tablaFacturas" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Número</th>
                    <th>Cliente</th>
                    <th>Fecha</th>
                    <th>Estado</th>
                    <th>Total</th>
                    <th>Acciones</th>
                </tr>
            </thead>
        </table>
    </div>
</div>

<!-- Modal Crear/Editar -->
<div class="modal fade" id="modalFactura" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalFacturaTitulo">Factura</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formFactura">
                    <input type="hidden" id="facturaId" />
                    <div class="mb-3">
                        <label for="facturaCliente" class="form-label">Cliente</label>
                        <select class="form-select" id="facturaCliente" required>
                            <option value="">Seleccione un cliente...</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="facturaNumero" class="form-label">Número de Factura</label>
                        <input type="text" class="form-control" id="facturaNumero" required />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btnGuardarFactura">Guardar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Ver -->
<div class="modal fade" id="modalVerFactura" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Detalle de la Factura</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <dl class="row">
                    <dt class="col-sm-3">ID:</dt>
                    <dd class="col-sm-9" id="verFacturaId"></dd>
                    
                    <dt class="col-sm-3">Número:</dt>
                    <dd class="col-sm-9" id="verFacturaNumero"></dd>
                    
                    <dt class="col-sm-3">Cliente:</dt>
                    <dd class="col-sm-9" id="verFacturaCliente"></dd>
                    
                    <dt class="col-sm-3">Fecha:</dt>
                    <dd class="col-sm-9" id="verFacturaFecha"></dd>
                    
                    <dt class="col-sm-3">Estado:</dt>
                    <dd class="col-sm-9" id="verFacturaEstado"></dd>
                    
                    <dt class="col-sm-3">Total:</dt>
                    <dd class="col-sm-9" id="verFacturaTotal"></dd>
                </dl>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <a class="btn btn-primary" id="btnVerDetalle">Ver Detalle Completo</a>
            </div>
        </div>
    </div>
</div>

<!-- Modal Anular -->
<div class="modal fade" id="modalAnularFactura" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Anular Factura</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formAnular">
                    <input type="hidden" id="anularFacturaId" />
                    <div class="mb-3">
                        <label for="motivoAnulacion" class="form-label">Motivo de Anulación</label>
                        <textarea class="form-control" id="motivoAnulacion" rows="3" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-danger" id="btnConfirmarAnular">Anular</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/facturas.js"></script>
}
